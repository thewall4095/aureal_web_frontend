<div class="profile-container">
    <div class="heading">My Profile</div>
    <div class="userprofile-section" *ngIf="userDetails">
        <div class="d-flex w100 mb-2">
            <div class="user-image">
                <div>
                    <div class="user-image-avatar" *ngIf="!userDetails.img">
                        <span *ngIf="!isImageUploading">{{getAvatarText(userDetails?.username)}}</span>
                        <span *ngIf="isImageUploading"><i class="fas fa-spinner fa-spin" aria-hidden="true"></i></span>
                    </div>
                    <div *ngIf="userDetails.img">
                        <img [src]="userDetails.img" class="lazyload">
                    </div>
                </div>
                <div class="edit-icon" *ngIf="isProfileFormOpen">
                    <input type="file" (change)="onFileChanged($event)" style="display: none" #fileInput>
                    <mat-icon (click)="fileInput.click()">edit</mat-icon>
                </div>
            </div>
            <div class="the-form" *ngIf="isProfileFormOpen">
                <form [formGroup]="profileForm" (ngSubmit)="onSubmit(profileForm.value)" class="form">
                    <div class="row">
                        <div class="col-6">
                            <mat-form-field class="form-element">
                                <label class="accenttwo">Display name</label>
                                <input matInput formControlName="username">
                                <mat-error
                                    *ngIf="!profileForm.controls['username'].valid && profileForm.controls['username'].touched">
                                    {{ getErrorusername(profileForm) }}
                                </mat-error>
                            </mat-form-field>
                        </div>
                        <div class="col-6">
                            <mat-form-field class="form-element">
                                <label class="accenttwo">Website</label>
                                <input matInput formControlName="website">
                            </mat-form-field>
    
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-12">
                            <mat-form-field class="form-element">
                                <label class="accenttwo">About</label>
                                <textarea matInput formControlName="bio"></textarea>
                            </mat-form-field>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-4">
                            <mat-form-field class="form-element">
                                <label class="accenttwo">Linkedin</label>
                                <input matInput formControlName="linkedin">
                            </mat-form-field>
                        </div>
                        <div class="col-4">
                            <mat-form-field class="form-element">
                                <label class="accenttwo">Instagram</label>
                                <input matInput formControlName="instagram">
                            </mat-form-field>
                        </div>
                        <div class="col-4">
                            <mat-form-field class="form-element">
                                <label class="accenttwo">Twitter</label>
                                <input matInput formControlName="twitter">
                            </mat-form-field>
                        </div>
                    </div>

                    <div class="form-element">
                        <div class="d-flex align-items-center">
                            <!-- <button mat-raised-button color="primary" type="submit" class="button"
                            [disabled]="!profileForm.valid || isImageUploading">Edit<i class="fas fa-spinner fa-spin"
                                *ngIf="isImageUploading" aria-hidden="true"></i></button> -->

                            <button class="primary-but" type="submit" [disabled]="!profileForm.valid || isImageUploading">
                                Update
                                <i class="fas fa-spinner fa-spin"
                                *ngIf="isImageUploading" aria-hidden="true"></i>
                            </button>
                            <button class="secondary-but ml-3" (click)="isProfileFormOpen=false">
                                <span>
                                    Discard
                                </span>
                            </button>
                        </div>

                    </div>
                </form>
            </div>
        </div>
        <div class="user-details" *ngIf="!isProfileFormOpen">
            <h3>{{userDetails?.username}}</h3>
            <p class="text-truncate accenttwo" [innerHTML]="userDetails?.settings?.Account?.Bio"></p>
            <div class="social-links">
                <div class="each-link" *ngIf="userDetails?.website">
                    <a [href]="userDetails?.website">
                        <span class="icon icon-web">
                        </span>
                    </a>
                </div>
                <div class="each-link" *ngIf="userDetails?.instagram">
                    <a [href]="userDetails?.instagram">
                        <span class="icon icon-instagrem">
                        </span>
                    </a>
                </div>
                <div class="each-link" *ngIf="userDetails?.twitter">
                    <a [href]="userDetails?.twitter">
                        <span class="icon icon-social-twitter">
                        </span>
                    </a>
                </div>
                <div class="each-link" *ngIf="userDetails?.linkedin">
                    <a [href]="userDetails?.linkedin">
                        <span class="icon icon-linkedin">
                        </span>
                    </a>
                </div>
            </div>
        </div>
        <div>
            <div class="edit-all-icon" (click)="isProfileFormOpen = !isProfileFormOpen">
                <mat-icon *ngIf="!isProfileFormOpen">edit</mat-icon>
                <mat-icon *ngIf="isProfileFormOpen">close</mat-icon>
            </div>
        </div>
    </div>
    <div class="userprofile-section" *ngIf="unclaimedText">
        <div class="d-flex justify-content-between align-items-center w100 row" style="padding:15px;">
            <h3>{{unclaimedText}}</h3>
            <button mat-raised-button color="primary" (click)="claimRewards()">Redeem Rewards(Transfer To
                Balance)</button>
        </div>
    </div>
    <div class="userpodcasts-section">
        <div class="heading">Your Podcasts</div>
        <div class="d-flex">
            <div class="podcast-card" *ngFor="let podcast of podcasts; let podcastIndex = index;">
                <img defaultImage="https://aurealbucket.s3.us-east-2.amazonaws.com/thumbnailnew.png" [lazyLoad]="podcast.image" class="lazyload">
                <div class="flex flex-column">
                  <div class="podcast-name">
                    {{podcast.name}}
                  </div>
                  <div>
                      <span class="vote-count" (click)="redirectToPodcast(podcast)"> 
                        <span>
                            Go to podcast page
                        </span>  
                        <span class="icon icon-right-open-big">
                        </span>
                      </span>
                  </div>
                </div>
            </div>
            <div class="podcast-card" (click)="redirectToPost()">
                <div class="dummy-image">
                    <span class="icon icon-plus-square-o"></span>
                </div>
                <div class="flex flex-column">
                  <div class="podcast-name">
                   Add a podcast
                  </div>
                </div>
            </div>
        </div>
    </div>
    <div class="userpodcasts-section">
        <div class="heading">Your Rooms</div>
        <div class="d-flex">
            <div class="podcast-card" *ngFor="let room of rooms; let podcastIndex = index;">
                <img defaultImage="https://aurealbucket.s3.us-east-2.amazonaws.com/thumbnailnew.png" [lazyLoad]="room.imageurl" class="lazyload">
                <div class="flex flex-column">
                  <div class="podcast-name">
                    {{room.title}}
                  </div>
                  <div>
                      <span class="vote-count" (click)="redirectToRoom(room)"> 
                        <span>
                            Go to room
                        </span>  
                        <span class="icon icon-right-open-big">
                        </span>
                      </span>
                  </div>
                </div>
            </div>
            <div class="podcast-card" (click)="redirectToCreateRoom()">
                <div class="dummy-image">
                    <span class="icon icon-plus-square-o"></span>
                </div>
                <div class="flex flex-column">
                  <div class="podcast-name">
                   Create Room
                  </div>
                </div>
            </div>
        </div>
    </div>
    <div class="userpodcasts-section">
        <div class="heading">Preferences</div>
        <div class="userprofile-section">
            <div class="sub-heading">
                Your interests
            </div>
            <div class="catgories-section mt-2 mb-4">
                <div *ngFor="let category of categories" class="each-category" 
                    [ngClass]="{'selected' : category.follows}"
                    >
                    <span (click)="selectCategory(category)">
                        {{category.name}}
                    </span>
                    <span class="icon ml-2 pointer accenttwo" (click)="removeSelectedCategory(category)"
                        *ngIf="category.follows" >x</span>
                 </div>
            </div>
            <!-- <div class="sub-heading">
                Language
            </div>
            <div class="catgories-section mt-2 mb-4">
                <div *ngFor="let category of languages" class="each-category" 
                    [ngClass]="{'selected' : category.follows}"
                    >
                    <span (click)="selectLanguages(category)">
                        {{category.name}}
                    </span>
                    <span class="icon ml-2 pointer accenttwo" (click)="removeSelectedLanguages(category)"
                        *ngIf="category.follows" >x</span>
                 </div>
            </div> -->
        </div>
    </div>
    <div class="userpodcasts-section" *ngIf="ownReferralLink">
        <div class="heading">Your referral link</div>
        <div class="sub-heading">
            Invite your podcaster friends to Aureal and get 10% percent of Author rewards for their first 2 episodes published on Aureal!
        </div>
        <div class="referral-container relative pointer">
           <!-- <input class="accenttwo" [disabled]="true" [(ngModel)]="ownReferralLink"> -->
           <div class="mt-3 mb-3">
            <span class="accenttwo mr-3"> Copy your code</span>
            <span class="input-container">
                <span class="accent font-weight-bold mr-2">{{ownReferralLink}}</span>
                <!-- <span class="icon icon-copy2" [cdkCopyToClipboard]="ownReferralLink"></span> -->
                <span class="icon icon-copy2" (click)="copyReferralCode()"></span>
            </span>

           </div>
           <div class="invite-but mt-3 mb-3" (click)="redirectToReferral()">
            Invite
           </div>
        </div>
    </div>
    <div class="userpodcasts-section">
        <div class="heading">Account</div>
        <div class="logout-but pointer" (click)="logout()">
            Sign Out
        </div>
    </div>

</div>